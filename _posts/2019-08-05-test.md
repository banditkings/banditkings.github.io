---
title: "test page"
date: 2019-08-05
tags: [excel, r, python]
excerpt: "Some basic markdown"
mathjax: "true"
---

# H1 Heading
## H2 Heading

**This is Bold**

Here's some basic body text. But this is *italics*. 

Python code block:
```python
    import numpy as np
    def test_function(x, y):
        z = np.sum(x, y)
        return z
```

R code block:
```r
    library(tidyverse)
    df <- read_csv("some_file.csv)
    head(df)
```

Here's some inline code: `x+y`.

Here's an image:
<img src="{{ site.url }}{{ site.baseurl }}/assets/images/bandit.png" alt="bandit">

Here's some math:

$$x+y=z$$

And here's some inline math $$ Z = x+y $$

# Excel Quick Access Toolbar Settings I Can’t Live Without
In corporate finance, you just can’t get away from Excel, so you might as well become faster and more efficient at it. While you can access a lot of excel’s functionality within 3-4 keystrokes (or, god forbid, a few mouse clicks), sometimes there’s a few functions that you keep reusing. You should add it to your Quick Access Toolbar!

For example, the shortcut for paste values is alt + e, s, v, and considering that you usually have to hit ctrl + c to copy something first, it ends up being an annoying amount of keypresses if you use this combo as much as I do and you’re under time pressure. So ‘paste values’ becomes my first item on the quick access toolbar, and I just need to hit ALT + 1 and I’ve eliminated two keystrokes for the rest of my analyst career.

Here’s how my quick access toolbar is set up:

1. Paste Values – I use this constantly to avoid pasting formulas
1. Format Painter
1. Center – fast formatting for column headers
1. Border Settings – fast formatting
1. Autofit Column Width
1. Autofit Row Height
1. Text to Columns – useful for cleaning data
1. Macro to custom format selected cell(s)
1. Macro to custom format all cells in the selected pivot table
1. Manage COM add-ins – my company uses a lot of excel add-ins that aren’t compatible with each other, so I need to toggle between various add-ins depending on the task at hand

The macros are there to convert the value in the cell to a specific $ format with no decimals and red parenthesis for negative values. I use this pattern constantly as a profit and loss analyst to present your analyses quickly to the executive waiting for your insights.

## Macros:
`
Sub Spends_Format()

'
' Spends_Format Macro
' Format Spends in $ format with negative values in red parentheses
'

'
    Selection.NumberFormat = "$#,##0_);[Red]($#,##0)"
End Sub
Sub Format_Pivot()
'
' Format_Pivot Macro
' Formats a column of a pivot in $
'
'
    On Error Resume Next
    Set pt = ActiveCell.PivotCell.PivotTable
    On Error GoTo 0
    If pt Is Nothing Then
        MsgBox "No PivotTable selected", vbInformation, "Oops..."
        Exit Sub
    End If
    For Each df In pt.DataFields
      df.NumberFormat = "$#,##0_);[Red]($#,##0)"
    Next df

End Sub
Sub Color_Format()
'
' Color_Format Macro
' Automatically formats the numbers to show blue if it's a constant, black if it's a formula, or green if it's a linked formula
' Keyboard Shortcut: Ctrl+Shift+C
'

Dim cell As Range, constantCells As Range, formulaCells As Range
Dim cellFormula As String
With Selection
    On Error Resume Next
        Set constantCells = .SpecialCells(xlCellTypeConstants, xlNumbers)
        Set formulaCells = .SpecialCells(xlCellTypeFormulas, 21)
    On Error GoTo 0
End With

If Not constantCells Is Nothing Then
    constantCells.Font.ThemeColor = xlThemeColorAccent1
    constantCells.Font.TintAndShade = 0
End If

If Not formulaCells Is Nothing Then
    For Each cell In formulaCells
        cellFormula = cell.Formula
        If cellFormula Like "*.xls*]*!*" Then
            cell.Font.ColorIndex = 3
        ElseIf cellFormula Like "*!*" And Not cellFormula Like "*\**" And Not cellFormula Like "*+*" And Not cellFormula Like "*-*" And Not cellFormula Like "*/*" And Not cellFormula Like "*%*" And Not cellFormula Like "*^*" And Not cellFormula Like "*>*" And Not cellFormula Like "*<*" And Not cellFormula Like "*>=*" And Not cellFormula Like "*<=*" And Not cellFormula Like "*<>*" And Not cellFormula Like "*&*" Then
            cell.Font.Color = -11489280
            cell.Font.TintAndShade = 0
        Else
            cell.Font.ColorIndex = 0
        End If
    Next cell
End If

End Sub
`
 